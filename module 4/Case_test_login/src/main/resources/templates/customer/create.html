<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form th:action="@{/customer/save}" th:object="${customer}" method="post">
    <table class="table table-striped table-hover table-bordered">
        <input type="hidden" name="id" size="45" th:field="*{id}">
        <tr>
            <th>Name:</th>
            <td>
                <input type="text" th:field="*{name}" required>
                <p style="color: red" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></p>
            </td>
        </tr>
        <tr>
            <th>Customer Type:</th>
            <td>
                <select id="type" th:field="*{customerType.id}">
                    <option th:each="customerType: ${customerTypeList}"
                            th:text="${customerType.name}"  th:value="${customerType.id}">
                    </option>
                </select>
            </td>
        </tr>
        <tr>
            <th>Birthday:</th>
            <td>
                <input type="date" size="45" th:field="*{date}" required>
            </td>
        </tr>
        <tr>
            <th>Gender:</th>
            <td>
                <select th:field="*{gender}">
                    <option th:value="true">Nam</option>
                    <option th:value="false">Ná»¯</option>
                </select>
            </td>
        </tr>
        <tr>
            <th>Id Card:</th>
            <td>
                <input type="text" th:field="*{idCard}" required>
            </td>
        </tr>
        <tr>
            <th>Phone:</th>
            <td>
                <input type="text" th:field="*{phone}" required>
            </td>
        </tr>
        <tr>
            <th>Email:</th>
            <td>
                <input type="text" th:field="*{email}" required>
            </td>
        </tr>
        <tr>
            <th>Address:</th>
            <td>
                City: <select id="city" onchange="getId()">
                <option value="" selected="selected"></option>
            </select>
                <br><br>
                District: <select id="district">
<!--                <option value="" selected="selected" ></option>-->
                <option th:each="customerType: ${customerTypeList}"
                        th:text="${customerType.name}"  th:value="${customerType.id}">
                </option>
            </select>

                <br><br>
                Ward: <select th:field="*{ward}">
                <option value="" selected="selected" th:text="${customer.ward}"></option>
            </select>
            </td>
        </tr>
        <tr>
            <th>Picture:</th>
            <td>
                <input id="file" type="file" th:field="*{picture}" th:text="${customer.picture}" required>
                <img id="img" type="file" src="/empty.png" height="100px" width="100px"
                     onclick="clickImg()">
            </td>
        </tr>
        <tr>
            <td colspan="2" align="center">
                <!--                                    <input type="submit" value="Save" class="btn btn-success text-white">-->
                <button id="save" type="submit" class="btn btn-success text-white">Save</button>
            </td>
        </tr>
    </table>
</form>

<script>
    $('#type').selectize();
</script>

<script>
    var readURL = function(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#img').attr('src', e.target.result);
            }

            reader.readAsDataURL(input.files[0]);
        }
    }
    function clickImg() {
        $('#file').click()
    }
    $("#file").on('change', function(){
        readURL(this);
    });
</script>
<script th:inline="javascript">
    /*<![CDATA[*/
    let city = /*[[${city}]]*/ 'default';
    let district = /*[[${district}]]*/ 'default';
    console.log(city)
    console.log(district)
    $(document).ready(
        function () {
            for (let i =0; i< city.length; i++){
                var x = document.createElement("OPTION");
                x.setAttribute("value", city[i].id);
                var t = document.createTextNode(city[i].name);
                x.appendChild(t);
                document.getElementById("city").appendChild(x);
            }
        }
    )
    /*]]>*/
</script>
<script th:inline="javascript">
    function getId() {
        var value = $('#city :selected').val()
        $.ajax({
            type: "GET",
            url: "/customer/listDistrict/" + value,
            dataType: "HTML",
            success: function (data) {
                /*<![CDATA[*/
                console.log(data)
                let district = /*[[${district}]]*/ 'default'
                $(document).ready(
                    function () {
                        console.log(district)
                        console.log(city[0].name)
                    }
                )
                /*]]>*/
            }
        });
    }
</script>
<!--<script src="/javascript/case_study.js"></script>-->
<!--<script>-->
<!--    function test() {-->
<!--        var value = $('select#type option:selected'). val()-->
<!--        $.ajax({-->
<!--            type: "GET",-->
<!--            url: "/customer/create/",-->
<!--            dataType: "HTML",-->
<!--            success: function (data) {-->
<!--                $(".modal-view").html(data);-->
<!--                $("#modelView").modal('show');-->
<!--            }-->
<!--        });-->
<!--    }-->
<!--</script>-->
</body>
</html>